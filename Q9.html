<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Questão 9</title>
    <link rel="stylesheet" href="styleQ6789.css">
</head>
<body>
    <div class="cx_perguntas">
        <div class="pergunta">
            <span>Cerro Corá é considerado um marco histórico. Neste local ocorreu a morte do presidente do Paraguai, Marechal Francisco Solano López. Responda essa afirmação com Verdadeiro ou Falso:</span>
        </div>
        <div class="alternativas">
            <label>
                <input type="radio" name="a9" value="Verdadeiro">
                <span>Verdadeiro</span>
            </label>
        </div>
        <div class="alternativas">
            <label>
                <input type="radio" name="a9" value="Falso">
                <span>Falso</span>
            </label>
        </div>
    </div>
    
    <div class="btnEnv">
        <button class="btnEnviar" onclick="salvarResposta('a9')">Enviar</button>
    </div>

    <div class="progress">
        <div class="progress-bar"></div>
    </div>

    <div class="btnS">
        <a href="Quiz.html" onclick="sessionStorage.clear();"><button class="btnSair">Voltar ao modo de jogo</button></a>
    </div>
    <script>
        // Atualiza a barra de progresso com base no índice da questão atual
        function updateProgressBar() {
            const questionsOrder = JSON.parse(sessionStorage.getItem('questionsOrder')) || [];
            const totalPerguntas = questionsOrder.length;
            const currentQuestionIndex = parseInt(sessionStorage.getItem('currentQuestionIndex'), 10) || 0;
            const progresso = (currentQuestionIndex / totalPerguntas) * 100;
            document.querySelector('.progress-bar').style.width = `${progresso}%`;
        }

        // Salva a resposta do usuário e avança para a próxima pergunta
        function salvarResposta(pergunta) {
            const selectedAnswer = document.querySelector(`input[name="${pergunta}"]:checked`);
            const respostaCorreta = "Verdadeiro"; // Atualizando com a resposta correta esperada
            
            if (selectedAnswer) {
                if (selectedAnswer.value === respostaCorreta) {
                    selectedAnswer.parentElement.style.backgroundColor = "green";
                    let correctAnswers = parseInt(sessionStorage.getItem('correctAnswers') || '0', 10);
                    sessionStorage.setItem('correctAnswers', correctAnswers + 1);
                } else {
                    selectedAnswer.parentElement.style.backgroundColor = "red";
                    document.querySelector(`input[name="${pergunta}"][value="${respostaCorreta}"]`).parentElement.style.backgroundColor = "green";
                }
                sessionStorage.setItem(pergunta, selectedAnswer.value);

                // Atualiza o índice da pergunta respondida
                let currentQuestionIndex = parseInt(sessionStorage.getItem('currentQuestionIndex'), 10) || 0; 
                currentQuestionIndex++; 
                sessionStorage.setItem('currentQuestionIndex', currentQuestionIndex);

                // Atualiza a barra de progresso
                //updateProgressBar();

                // Redireciona para a próxima pergunta
                setTimeout(() => {
                    nextQuestion();
                }, 1000);
            }
        }

        // Avança para a próxima pergunta
        function nextQuestion() {
            const questionsOrder = JSON.parse(sessionStorage.getItem('questionsOrder')) || [];
            let currentQuestionIndex = parseInt(sessionStorage.getItem('currentQuestionIndex'), 10); 

            if (currentQuestionIndex < questionsOrder.length) {
                console.log(`Indo para a próxima pergunta: ${questionsOrder[currentQuestionIndex]}`);
                window.location.href = questionsOrder[currentQuestionIndex];
            } else {
                console.log('Fim do quiz - redirecionando para feedback');
                window.location.href = 'feedback_aluno.html';
            }
        }

        // Inicializa o quiz com perguntas embaralhadas ou sequenciais
        function startQuiz(random = true) {
            const questions = ["Q1.html", "Q2.html", "Q3.html", "Q4.html", "Q5.html", "Q6.html", "Q7.html", "Q8.html", "Q9.html"];
            const questionsOrder = random ? shuffle([...questions]) : [...questions];
            sessionStorage.setItem('questionsOrder', JSON.stringify(questionsOrder));
            sessionStorage.setItem('currentQuestionIndex', 0);

            // Atualiza a barra de progresso ao iniciar o quiz
            updateProgressBar();
        }

        /* // Função para embaralhar o array de perguntas
        function shuffle(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        } */

        // Atualiza a barra de progresso ao carregar a página
        document.addEventListener("DOMContentLoaded", updateProgressBar);
    </script>
</body>
</html>
